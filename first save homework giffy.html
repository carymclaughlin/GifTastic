<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Favorite animals</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css" />
</head>

<body>
  <div class="container">
    <h1>Animal Search</h1>

    
    <div id="animal-buttons">

    </div>


    <form id="animal-form">
      <label for="animal-input">Search for a animal</label>
      <input type="text" id="animal-input"><br>

      <input id="find-animal" type="submit" value="animal Search">
    </form>
      <div id="animal-view"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
     
      let firstAnimals = ["hippo", "cheetah", "lizard", "giraffe", "tiger", "bear", "horse", "goat", "whale", "squid", "owl", "snail", "lamb", "mouse", "rabbit", "frog","turtle", "wolf", "cow", "hawk", "jellyfish", "snake",]
        //ok I know I'm probably supposed to run this through the same function as the click.. and I'm supposed to add new inputs into the array.
        //the problem is by the time I wrote this portion of the code I'd already gotten that funcationality from the 3 point on click function..
        //so I removed my test buttons and ran the array through a duplicate of the function with a loop on ready.
      $( document ).ready(function() {
            console.log( "document loaded" );

            for (var i = 0; i < firstAnimals.length; i++) {

            let newButton = $("<button>");

            newButton.text(firstAnimals[i]);

            newButton.addClass("animal-button");

            $("#animal-buttons").append(newButton);
            }
         });
        
      $("#find-animal").on("click", function(event) {

            event.preventDefault();

            var animal = $("#animal-input").val();

            let newButton = $("<button>");

            newButton.text(animal)

            newButton.addClass("animal-button");

            $("#animal-buttons").append(newButton);

      });

      $(document).on("click", ".animal-button", function(){
        let animal = $(this).text()
        console.log(animal)

      var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
        animal + "&api_key=dc6zaTOxFJmzC&limit=10";

      $.ajax({
        url: queryURL,
        method: "GET"
      })

        .then(function(response) {
   
          var results = response.data;

          console.log(results)

          for (var i = 0; i < results.length; i++) {

       
            if (results[i].rating !== "r" && results[i].rating !== "pg-13") {
                // I doubt there are that many R rated buffalos ;)

              var gifDiv = $("<div class='item'>");

              var rating = results[i].rating;

              var p = $("<p>").text("Rating: " + rating);

              var animalImage = $("<img>");
              
                //the most challanging portion of the assignment.  I had some issues with the syntax..
              animalImage.attr("src", results[i].images.original_still.url);

              animalImage.attr("data-still", results[i].images.original_still.url);

              animalImage.attr("data-animate", results[i].images.downsized_medium.url);

              animalImage.attr("data-state", "still");

              animalImage.addClass("gif");

              gifDiv.append(p);
              gifDiv.append(animalImage);

              $("#animal-view").prepend(gifDiv);
                }
            }     $(".gif").on("click", function() {
                console.log("clicked");
            //I initially assumed this state changing function could go anywhere.  It did not operate when it wasn't tied into the gif delivery.
                    var state = $(this).attr("data-state");
                
                    if (state === "still") {
                        $(this).attr("src", $(this).attr("data-animate"));
                        $(this).attr("data-state", "animate");
                    } else {
                        $(this).attr("src", $(this).attr("data-still"));
                        $(this).attr("data-state", "still");
                    }
                    });
            });
    });
     
 
    </script>
  </div>
</body>

</html>
